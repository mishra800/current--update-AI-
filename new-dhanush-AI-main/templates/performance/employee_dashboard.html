{% extends "base.html" %}
{% block content %}

<div class="dashboard-container">

    <h2 class="title">üë§ Employee Dashboard ‚Äî ID #{{ employee_id }}</h2>

    <!-- Risk Score Cards -->
    <div class="risk-section">
        <div class="risk-card">
            <h3>Attrition Risk</h3>
            <p class="risk-value">{{ risks.attrition_risk }}</p>
        </div>
        <div class="risk-card">
            <h3>Burnout Risk</h3>
            <p class="risk-value">{{ risks.burnout_risk }}</p>
        </div>
    </div>

    <!-- Recent Metrics -->
    <h3 class="section-title">üìà Recent Work Metrics</h3>
    <div class="table-wrapper">
        <table class="styled-table">
            <tr>
                <th>Date</th>
                <th>Hours Worked</th>
                <th>Leaves Taken</th>
                <th>Feedback Score</th>
                <th>Tasks Completed</th>
            </tr>
            {% for m in metrics %}
            <tr>
                <td>{{ m.date }}</td>
                <td>{{ m.hours_worked or '-' }}</td>
                <td>{{ m.leaves_taken or 0 }}</td>
                <td>{{ m.avg_feedback_polarity or '-' }}</td>
                <td>{{ m.tasks_completed or 0 }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>

    <!-- Recent Feedback -->
    <h3 class="section-title">üí¨ Recent Feedback</h3>
    <div class="list-box">
        {% for f in feedbacks %}
        <div class="feedback-item">
            <span class="feedback-date">{{ f.created_at }}</span>
            <p>{{ f.text[:160] }}{% if f.text|length > 160 %}...{% endif %}</p>
            <small>Sentiment: {{ f.polarity }}</small>
        </div>
        {% endfor %}
    </div>

    <!-- Recent Reviews -->
    <h3 class="section-title">üìù Recent Performance Reviews</h3>
    <div class="list-box">
        {% for r in reviews %}
        <div class="review-item">
            <span class="review-date">{{ r.created_at }}</span>
            <span>Overall Score: <b>{{ r.overall_score }}</b></span>
            <a href="{{ url_for('performance.view_review', review_id=r.id) }}" class="view-link">View Details ‚Üí</a>
        </div>
        {% endfor %}
    </div>

</div>

<style>
.dashboard-container {
    max-width: 1000px;
    margin: auto;
    padding: 25px;
}
.title {
    text-align: center;
    color: #024cab;
    font-weight: 700;
    margin-bottom: 25px;
}
.risk-section {
    display: flex;
    gap: 20px;
    justify-content: center;
    margin-bottom: 30px;
}
.risk-card {
    background: #fff;
    padding: 18px 25px;
    border-radius: 10px;
    text-align: center;
    box-shadow: 0 4px 14px rgba(0,0,0,0.12);
    width: 200px;
}
.risk-value {
    font-size: 26px;
    margin-top: 8px;
    font-weight: bold;
    color: #d9534f;
}
.section-title {
    margin-top: 30px;
    margin-bottom: 10px;
    color: #222;
    font-weight: 600;
}
.table-wrapper {
    overflow-x: auto;
}
.styled-table {
    width: 100%;
    border-collapse: collapse;
    box-shadow: 0 4px 16px rgba(0,0,0,0.08);
}
.styled-table th {
    background: #024cab;
    color: white;
    padding: 10px;
    text-align: center;
}
.styled-table td {
    padding: 10px;
    border-bottom: 1px solid #ddd;
    text-align: center;
}
.list-box {
    background: #fff;
    padding: 18px;
    border-radius: 10px;
    box-shadow: 0 4px 14px rgba(0,0,0,0.12);
}
.feedback-item,
.review-item {
    border-bottom: 1px solid #eee;
    padding: 10px 0;
}
.feedback-item:last-child,
.review-item:last-child {
    border-bottom: none;
}
.feedback-date,
.review-date {
    font-size: 13px;
    color: #777;
}
.view-link {
    float: right;
    color: #024cab;
    font-weight: 600;
    text-decoration: none;
}
.view-link:hover {
    text-decoration: underline;
}
</style>

{% endblock %}
